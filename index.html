<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Physics Sim by Lall Ravi</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --iso-color: #3498db;
            --chr-color: #e67e22;
            --bar-color: #e74c3c;
            --bg: #f8f9fa;
        }
        body { font-family: 'Times New Roman', Times, serif; background: var(--bg); display: flex; flex-direction: column; align-items: center; padding: 20px; }
        .container { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); max-width: 1000px; width: 100%; min-height: 80vh; }
        
        .step-container { display: none; animation: fadeIn 0.6s ease-in-out forwards; }
        .active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        .graph-display { display: flex; flex-direction: column; align-items: center; gap: 20px; margin-top: 20px; }
        .canvas-wrapper { width: 500px; height: 350px; background: #fff; border: 1px solid #eee; border-radius: 10px; padding: 10px; }
        
        .explanation-text { background: #f1f8ff; border-left: 5px solid #3498db; padding: 20px; border-radius: 5px; margin: 20px 0; font-size: 1.2rem; line-height: 1.5; }
        .final-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-top: 20px; }
        .final-grid canvas { width: 100% !important; height: auto !important; border: 1px solid #ddd; }

        .controls { display: flex; justify-content: space-between; margin-top: 30px; padding-top: 20px; border-top: 2px solid #eee; }
        button { padding: 12px 30px; font-size: 1rem; cursor: pointer; border-radius: 5px; border: none; font-weight: bold; transition: 0.3s; }
        .next-btn { background: #2ecc71; color: white; }
        .next-btn:hover { background: #27ae60; }
        
        .header-tag { font-family: Arial, sans-serif; font-size: 0.9rem; letter-spacing: 2px; color: #7f8c8d; text-transform: uppercase; }
        .process-title { font-size: 2.5rem; margin: 10px 0; color: #2c3e50; }
        .math-display { font-size: 1.8rem; font-weight: bold; color: #000; margin: 15px 0; text-align: center; }
    </style>
</head>
<body>

    <header style="text-align:center; margin-bottom: 20px;">
        <h1 style="font-family: Arial; margin:0;">Physics Sim by Lall Ravi</h1>
    </header>

    <div class="container" id="mainSim">
        </div>

    <script>
        const stages = [
            // ISOTHERMAL
            { type: 'iso', title: 'Isothermal Process', eq: 'PV = Constant', sub: 'Graph 1: Pressure vs Temperature', xlabel: 'T', ylabel: 'P', data: [{x:5, y:2}, {x:5, y:8}], desc: 'In an Isothermal process, Temperature (T) remains constant. The graph shows a vertical line at the fixed temperature value.' },
            { type: 'iso', title: 'Isothermal Process', eq: 'P₁V₁ = P₂V₂', sub: 'Graph 2: Pressure vs Volume', xlabel: 'V', ylabel: 'P', data: Array.from({length:9}, (_,i)=>({x:i+2, y:15/(i+2)})), desc: 'Boyle\'s Law: As Volume increases, Pressure decreases along a hyperbolic curve.' },
            { type: 'iso', title: 'Isothermal Process', eq: 'PV = Constant', sub: 'Graph 3: Volume vs Temperature', xlabel: 'T', ylabel: 'V', data: [{x:5, y:8}, {x:5, y:2}], desc: 'Similar to P vs T, the Volume vs Temperature graph is a vertical line because T does not change.' },
            { type: 'iso_all', title: 'Isothermal Summary', eq: 'Constant Temperature', desc: 'All three representations of the Isothermal process together.' },
            
            // ISOCHORIC
            { type: 'chr', title: 'Isochoric Process', eq: 'P / T = Constant', sub: 'Graph 1: Pressure vs Temperature', xlabel: 'T', ylabel: 'P', data: [{x:2, y:2}, {x:8, y:8}], desc: 'Pressure increases linearly with Temperature when Volume is held constant.' },
            { type: 'chr', title: 'Isochoric Process', eq: 'Volume is Fixed', sub: 'Graph 2: Pressure vs Volume', xlabel: 'V', ylabel: 'P', data: [{x:5, y:2}, {x:5, y:8}], desc: 'Because Volume is constant, the P vs V graph is a vertical line at the specific volume value.' },
            { type: 'chr', title: 'Isochoric Process', eq: 'V = Constant', sub: 'Graph 3: Volume vs Temperature', xlabel: 'T', ylabel: 'V', data: [{x:2, y:5}, {x:8, y:5}], desc: 'Volume remains unchanged regardless of the temperature, appearing as a horizontal line.' },
            { type: 'chr_all', title: 'Isochoric Summary', eq: 'Constant Volume', desc: 'All three representations of the Isochoric process together.' },

            // ISOBARIC
            { type: 'bar', title: 'Isobaric Process', eq: 'V / T = Constant', sub: 'Graph 1: Pressure vs Temperature', xlabel: 'T', ylabel: 'P', data: [{x:2, y:5}, {x:8, y:5}], desc: 'Pressure is held constant, appearing as a horizontal line on a P vs T graph.' },
            { type: 'bar', title: 'Isobaric Process', eq: 'P = Constant', sub: 'Graph 2: Pressure vs Volume', xlabel: 'V', ylabel: 'P', data: [{x:2, y:5}, {x:8, y:5}], desc: 'The Pressure vs Volume graph is horizontal, indicating Pressure does not change as the gas expands.' },
            { type: 'bar', title: 'Isobaric Process', eq: 'V₁ / T₁ = V₂ / T₂', sub: 'Graph 3: Volume vs Temperature', xlabel: 'T', ylabel: 'V', data: [{x:2, y:2}, {x:8, y:8}], desc: 'Charles\'s Law: Volume increases linearly with Temperature at a constant Pressure.' },
            { type: 'bar_all', title: 'Isobaric Summary', eq: 'Constant Pressure', desc: 'All three representations of the Isobaric process together.' }
        ];

        let currentStage = 0;

        function renderStage() {
            const stage = stages[currentStage];
            const container = document.getElementById('mainSim');
            let color = stage.type.includes('iso') ? '#3498db' : stage.type.includes('chr') ? '#e67e22' : '#e74c3c';

            let html = `
                <div class="step-container active">
                    <div class="header-tag">Thermodynamics Sim</div>
                    <h2 class="process-title">${stage.title}</h2>
                    <div class="math-display">${stage.eq}</div>
            `;

            if (stage.type.endsWith('_all')) {
                html += `
                    <div class="final-grid">
                        <div class="graph-box"><canvas id="f1"></canvas></div>
                        <div class="graph-box"><canvas id="f2"></canvas></div>
                        <div class="graph-box"><canvas id="f3"></canvas></div>
                    </div>
                    <div class="explanation-text" style="border-color:${color}">${stage.desc}</div>
                `;
            } else {
                html += `
                    <h3 style="text-align:center; color:#7f8c8d;">${stage.sub}</h3>
                    <div class="graph-display">
                        <div class="canvas-wrapper"><canvas id="currentGraph"></canvas></div>
                        <div class="explanation-text" style="border-color:${color}">${stage.desc}</div>
                    </div>
                `;
            }

            html += `
                <div class="controls">
                    <button onclick="prevStage()" class="next-btn" style="background:#95a5a6">Back</button>
                    <button onclick="nextStage()" class="next-btn">Continue ➔</button>
                </div>
            </div>`;

            container.innerHTML = html;
            
            if (stage.type.endsWith('_all')) {
                const baseType = stage.type.split('_')[0];
                const set = stages.filter(s => s.type === baseType);
                set.forEach((s, i) => createChart(`f${i+1}`, s.xlabel, s.ylabel, s.data, color, s.type === 'iso' && i === 1));
            } else {
                createChart('currentGraph', stage.xlabel, stage.ylabel, stage.data, color, stage.type === 'iso' && stage.sub.includes('Volume'));
            }
        }

        function createChart(id, xl, yl, data, color, isCurve) {
            new Chart(document.getElementById(id), {
                type: 'line',
                data: { datasets: [{ data: data, borderColor: color, borderWidth: 4, pointRadius: 5, fill: false, tension: isCurve ? 0.4 : 0 }] },
                options: {
                    animation: { duration: 1000 },
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { type: 'linear', title: { display: true, text: xl }, ticks: { display: false }, grid: { display: false } },
                        y: { type: 'linear', title: { display: true, text: yl }, ticks: { display: false }, grid: { display: false } }
                    }
                }
            });
        }

        function nextStage() {
            if (currentStage < stages.length - 1) { currentStage++; renderStage(); }
            else { alert("Simulation Complete! By Ravi Lall"); location.reload(); }
        }

        function prevStage() {
            if (currentStage > 0) { currentStage--; renderStage(); }
        }

        renderStage();
    </script>
</body>
</html>